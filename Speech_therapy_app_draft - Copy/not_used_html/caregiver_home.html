{% extends "base.html" %}
{% block content %}
  <h2>Caregiver: Patient Stats</h2>
  {% if history %}
    {% for sess in history %}
      <div class="session-block">
        <strong>{{ sess.timestamp }}</strong>
        <canvas id="cgChart{{ loop.index0 }}" width="300" height="150"></canvas>
      </div>
    {% endfor %}
  {% else %}
    <p>No patient sessions yet.</p>
  {% endif %}
  <script>
    {% for sess in history %}
      new Chart(
        document.getElementById('cgChart{{ loop.index0 }}').getContext('2d'),
        {
          type: 'bar',
          data: {
            labels: {{ labels|tojson }},
            datasets: [{ data: {{ sess.performance|tojson }}, label: 'Improvement', borderWidth:1 }]
          },
          options: { scales:{ y:{ beginAtZero:true, max:100 } } }
        }
      );
    {% endfor %}
  </script>
{% endblock %}
